<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>éŠæˆ²æ­å¥½è¡Œ é‡‘é–€æ¨‚éŠç©åˆ°åº•</title>
  <meta name="theme-color" content="#0b0c10" />
  <style>
    :root{
      font-family: system-ui, -apple-system, "Noto Sans TC", Segoe UI, Roboto, Arial;
      --bg:#0b0c10; --card:#141622; --line:rgba(255,255,255,.10);
      --muted:rgba(255,255,255,.78); --soft:rgba(255,255,255,.06);
      --pri:#7aa2ff;
    }
    body{margin:0;background:var(--bg);color:#fff}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:980px;margin:0 auto;padding:20px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:18px;padding:16px;margin:14px 0;box-shadow:0 10px 28px rgba(0,0,0,.28)}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    .pill{display:inline-flex;gap:8px;align-items:center;border:1px solid var(--line);padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.03);font-size:12px;opacity:.95}
    h1{font-size:26px;margin:8px 0 0}
    h2{font-size:16px;margin:0}
    .sub{color:var(--muted);font-size:13px;line-height:1.7;margin-top:8px}
    .tiny{color:var(--muted);font-size:12px;line-height:1.6}
    .btn{appearance:none;border:1px solid var(--line);background:#1d2140;color:#fff;border-radius:14px;padding:10px 12px;font-weight:900;cursor:pointer}
    .btn.secondary{background:transparent}
    .btn.pri{background:var(--pri);color:#0b0c10;border-color:rgba(0,0,0,.15)}
    .btn.good{background:#1f3d2c}
    .grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .game{border:1px solid var(--line);border-radius:16px;overflow:hidden;background:rgba(255,255,255,.03)}
    .cover{height:140px;background:linear-gradient(135deg, rgba(122,162,255,.35), rgba(255,255,255,.05));display:flex;align-items:center;justify-content:center}
    .cover span{font-weight:900;opacity:.9}
    .game .body{padding:12px}
    .tags{margin-top:8px}
    .tag{display:inline-block;margin-right:6px;margin-top:6px;border:1px solid var(--line);padding:4px 8px;border-radius:999px;font-size:12px;opacity:.9}
    .hr{height:1px;background:rgba(255,255,255,.08);margin:12px 0}
    .notice{background:rgba(255,255,255,.04);border:1px dashed rgba(255,255,255,.18);border-radius:14px;padding:12px}
    .footer{opacity:.75;font-size:12px;line-height:1.6;margin:18px 0 8px}
    @media (max-width:860px){.grid3{grid-template-columns:1fr}.grid2{grid-template-columns:1fr}}
  </style>
</head>
<body>

<!-- ===== TM å¹³å°å°è¦½åˆ—ï¼ˆå–®ä¸€ç‰ˆæœ¬ï¼Œå«æ’è¡Œæ¦œï¼‰ ===== -->
<script>
  const PORTAL_URL = "https://thtsai820-cpu.github.io/TM/";
</script>

<div style="
  position:sticky; top:0; z-index:9999;
  background:#141622;
  border-bottom:1px solid rgba(255,255,255,.12);
  padding:10px 12px;
  font-family:system-ui,-apple-system,'Noto Sans TC',Segoe UI,Roboto,Arial;
">
  <div style="max-width:900px;margin:0 auto;display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between">

    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <button onclick="location.href=PORTAL_URL+'leaderboard.html'"
        style="
          border:1px solid rgba(255,255,255,.18);
          background:#1f3d2c;
          color:#fff;
          border-radius:12px;
          padding:8px 10px;
          font-weight:900;
          cursor:pointer;
        ">
        ğŸ† æ’è¡Œæ¦œ
      </button>

      <span style="
        border:1px solid rgba(255,255,255,.18);
        border-radius:999px;
        padding:4px 8px;
        font-size:12px;
        color:rgba(255,255,255,.9);
      ">ğŸšŒ Aç·šä¸»é¡Œ</span>

      <span style="font-size:13px;color:rgba(255,255,255,.86)">
        éŠæˆ²æ­å¥½è¡Œï½œé‡‘é–€æ¨‚éŠç©åˆ°åº•
      </span>
    </div>

    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <button onclick="location.href=PORTAL_URL+'route-a.html'"
        style="
          border:1px solid rgba(255,255,255,.18);
          background:rgba(122,162,255,.95);
          color:#0b0c10;
          border-radius:12px;
          padding:8px 10px;
          font-weight:1000;
          cursor:pointer;
        ">
        ğŸ§­ æŸ¥çœ‹Aç·šæ€éº¼æ­
      </button>

      <button onclick="location.href=PORTAL_URL+'#games'"
        style="
          border:1px solid rgba(255,255,255,.18);
          background:transparent;
          color:#fff;
          border-radius:12px;
          padding:8px 10px;
          cursor:pointer;
        ">
        ğŸ® ä¸‰æ¬¾éŠæˆ²
      </button>

      <button onclick="location.href=PORTAL_URL"
        style="
          border:1px solid rgba(255,255,255,.18);
          background:#1d2140;
          color:#fff;
          border-radius:12px;
          padding:8px 10px;
          font-weight:900;
          cursor:pointer;
        ">
        â¬… å›é¦–é 
      </button>
    </div>

  </div>
</div>
<!-- ===== å°è¦½åˆ—çµæŸ ===== -->

<div class="wrap">
  <!-- Hero -->
  <div class="card" id="heroCard" style="position:relative;">
    <!-- Hero æˆå°±å¾½ç« ï¼ˆæµ®åœ¨å³ä¸Šè§’ï¼›è§£é–æ‰é¡¯ç¤ºï¼‰ -->
    <div id="heroBadgeFloat" style="display:none"></div>

    <div class="row">
      <div>
        <div class="pill">ğŸšŒ å°ç£å¥½è¡Œé‡‘é–€ç¸£ï½œAç·šä¸»é¡Œ</div>
        <h1>éŠæˆ²æ­å¥½è¡Œ é‡‘é–€æ¨‚éŠç©åˆ°åº•</h1>

        <div class="sub">
          <b>ç©å¾—é–‹å¿ƒï¼Œä¹Ÿæ›¿é‡‘é–€æ¸›ç¢³ã€‚</b><br/>
          æ­å°ç£å¥½è¡Œ Aç·šå®Œæˆä»»å‹™ã€æ‹¿å¾½ç« ã€ä¸Šæ’è¡Œæ¦œã€‚<br/>
          <b>ä¸€ç¥¨åˆ°åº•ï¼Œé‚Šç©é‚Šçœç¢³ã€‚</b>
        </div>
      </div>

      <div class="row" style="justify-content:flex-start">
        <button class="btn pri" id="startBtn">ç«‹å³é–‹å§‹ï¼ˆæ¨è–¦ï¼šå³æ™‚è§£è¬ï¼‰</button>
        <button class="btn secondary" id="howBtn">æ€éº¼ç©</button>
      </div>
    </div>

    <div class="hr"></div>

    <div class="grid2">
      <div class="notice">
        <div class="pill">ğŸ“ Aç·šç©æ³•å»ºè­°</div>
        <div class="tiny" style="margin-top:8px">
          1ï¼‰å…ˆç©ã€Œå³æ™‚è·¯ç·šè§£è¬ã€ï¼šåˆ°ç«™æ‰è§£é– â†’ ç›´æ¥å¸¶å‹•æ­ä¹˜<br/>
          2ï¼‰ä¸‹è»Šå¾Œç©ã€Œé›†ç« ã€ï¼šå®Œæˆå¾½ç«  â†’ ä¹‹å¾Œå¯ä¸²åˆä½œåº—å®¶å…Œæ›ï¼ˆç‰ˆä½å·²é ç•™ï¼‰<br/>
          3ï¼‰ç©ºæª”ç©ã€Œæ™¯é»å°„æ“Šã€ï¼šç”¨çœŸå¯¦æ™¯é»ç…§ç‰‡ç•¶èƒŒæ™¯ï¼Œç­‰å¾…ä¹Ÿä¸ç„¡èŠ
        </div>
      </div>
      <div class="notice">
        <div class="pill">ğŸ“² ä¹‹å¾Œå°‡å°å…¥ APP</div>
        <div class="tiny" style="margin-top:8px">
          æœ¬ç¶²ç«™æ˜¯å…ˆè¡Œç‰ˆè¡ŒéŠ·å…¥å£ã€‚æœªä¾†æœƒæŠŠåŒæ¨£çš„ã€Œä¸‰éŠæˆ²å…¥å£ã€æ¬é€² APP å…§ï¼Œä¸¦åŠ å…¥æ›´å¤šè·¯ç·šè³‡è¨Šèˆ‡æ–°å…§å®¹ã€‚
        </div>
      </div>
    </div>
  </div>

  <!-- ===== æ’è¡Œæ¦œå…¥å£ ===== -->
  <div class="card">
    <div class="row">
      <div>
        <div class="pill">ğŸ† ç©å®¶æˆç¸¾</div>
        <h2>å³æ™‚æ’è¡Œæ¦œ</h2>

        <div class="sub">
          æŸ¥çœ‹ã€Œå³æ™‚è§£è¬ã€é›†ç« ä»»å‹™ã€æ™¯é»å°„æ“Šã€çš„ç©å®¶æˆç¸¾ï¼Œ
          ä¾åˆ†æ•¸èˆ‡å®Œæˆæ™‚é–“è‡ªå‹•æ’åã€‚
        </div>

        <div class="tags">
          <span class="tag">Aç·šä¸»é¡Œ</span>
          <span class="tag">å³æ™‚è§£è¬</span>
          <span class="tag">åˆ°ç«™è§£é–</span>
          <span class="tag">åº—å®¶å…Œæ›</span>
        </div>
      </div>

      <button class="btn pri" onclick="location.href='leaderboard.html'">
        é€²å…¥æ’è¡Œæ¦œ
      </button>
    </div>

    <div class="hr"></div>

    <div class="tiny">
      ğŸ’¡ å°æé†’ï¼šæ’è¡Œæ¦œè³‡æ–™ç”±å„éŠæˆ²è‡ªå‹•é€å‡ºï¼Œ
      å¯ä½œç‚ºã€Œåˆ°åº—å…Œçã€æŠ½çè³‡æ ¼ã€æ´»å‹•æ’åã€ä½¿ç”¨ã€‚
    </div>
  </div>
  <!-- ===== æ’è¡Œæ¦œå…¥å£çµæŸ ===== -->

  <!-- ===== ä½ç¢³æ•™è‚²å½±ç‰‡ï¼šçœ‹å½±ç‰‡è§£é–å¾½ç«  ===== -->
  <div class="card" id="eco-video">
    <div class="row">
      <div>
        <div class="pill">ğŸŒ± ä½ç¢³å°å­¸å ‚</div>
        <h2>çœ‹å½±ç‰‡ï¼Œè§£é–ã€Œä½ç¢³æ—…äººã€å¾½ç« </h2>
        <div class="sub">
          è§€çœ‹é€™æ®µçŸ­å½±ç‰‡ï¼ˆNotebookLM ç”¢å‡ºï¼‰ï¼Œå®Œæˆå¾Œå¯è§£é–å¾½ç« ã€‚
          å¾½ç« æœƒé¡¯ç¤ºåœ¨ä½ çš„å¹³å°ä¸Šï¼Œä¹‹å¾Œä¹Ÿèƒ½è®“ä¸‰å€‹éŠæˆ²è®€åˆ°ï¼ˆåšæˆè·¨éŠæˆ²æˆå°±ï¼‰ã€‚
        </div>
        <div class="tags">
          <span class="tag">å¤§çœ¾é‹è¼¸</span>
          <span class="tag">ä½ç¢³æ—…éŠ</span>
          <span class="tag">æ•™è‚²ä»»å‹™</span>
        </div>
      </div>

      <div class="row" style="justify-content:flex-start">
        <span class="pill" id="ecoBadgePill">ğŸ”’ å°šæœªè§£é–</span>
        <button class="btn secondary" id="ecoResetBtn" type="button">é‡ç½®å¾½ç« </button>
      </div>
    </div>

    <div class="hr"></div>

    <div class="notice">
      <div class="tiny">
        âœ… è§£é–æ¢ä»¶ï¼šå½±ç‰‡æ’­æ”¾é” <b>90%</b>ï¼ˆæˆ–æ’­å®Œï¼‰ã€‚<br/>
        ğŸ“Œ å°æé†’ï¼šæ‰‹æ©Ÿä¸Šå»ºè­°é»ä¸€ä¸‹æ’­æ”¾ï¼›è‹¥æ²’æœ‰è²éŸ³å¯é–‹å•ŸéŸ³é‡æˆ–å–æ¶ˆéœéŸ³ã€‚
      </div>
    </div>

    <div style="margin-top:12px">
      <video
        id="ecoVideo"
        controls
        playsinline
        preload="metadata"
        style="width:100%;border-radius:16px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.03)"
      >
        <source src="assets/media/pod1.mp4" type="video/mp4" />
        ä½ çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾ã€‚
      </video>
    </div>

    <div class="tiny muted" style="margin-top:10px" id="ecoHint">
      å½±ç‰‡è¼‰å…¥ä¸­â€¦ï¼ˆè‹¥ç„¡æ³•æ’­æ”¾ï¼Œè«‹ç¢ºèªæª”æ¡ˆè·¯å¾‘æ˜¯å¦ç‚º <b>TM/assets/media/pod1.mp4</b>ï¼‰
    </div>
  </div>
  <!-- ===== ä½ç¢³æ•™è‚²å½±ç‰‡çµæŸ ===== -->

  <!-- Games -->
  <div class="card" id="games">
    <div class="row">
      <h2>ä¸‰æ¬¾éŠæˆ²ï¼ˆAç·šå…ˆè¡Œï¼‰</h2>
      <div class="pill">å°é¢åœ–ï¼šå…ˆæ”¾ä½”ä½ï¼ˆä½ æä¾›å¾Œå¯æ›¿æ›ï¼‰</div>
    </div>
    <div class="sub">é»å¡ç‰‡å³å¯é–‹å•ŸéŠæˆ²ï¼ˆæ–°åˆ†é ï¼‰ã€‚</div>

    <div class="grid3" style="margin-top:12px" id="gameGrid"></div>
  </div>

  <!-- How to play -->
  <div class="card" id="how">
    <h2>æ€éº¼ç©ï¼ˆ3 æ­¥é©Ÿï¼‰</h2>
    <div class="sub">
      â‘  é¸ä¸€æ¬¾éŠæˆ² â†’ â‘¡ åˆ°ç«™è§£é–/è¼¸å…¥ç«™ç¢¼ï¼ˆæˆ–å…ˆç”¨ demoï¼‰â†’ â‘¢ å®Œæˆä»»å‹™æ‹¿å¾½ç« ï¼Œåˆ†äº«çµ¦æœ‹å‹ä¸€èµ·æ­å¥½è¡Œã€‚
    </div>
    <div class="hr"></div>
    <div class="grid2">
      <div class="notice">
        <div class="pill">ğŸ§© å³æ™‚è§£è¬ï¼ˆä¸»æ¨ï¼‰</div>
        <div class="tiny" style="margin-top:8px">
          åœ¨è»Šä¸Šä¹Ÿèƒ½ç©ï¼šåˆ°ç«™æ‰è§£é–ä¸‹ä¸€é—œã€‚æœ€èƒ½æŠŠã€Œæ­ä¹˜ã€ç›´æ¥è®ŠæˆéŠæˆ²é€²åº¦ã€‚
        </div>
      </div>
      <div class="notice">
        <div class="pill">ğŸ§¾ é›†ç«  & ğŸ¯ å°„æ“Šï¼ˆè¼”æ¨ï¼‰</div>
        <div class="tiny" style="margin-top:8px">
          é›†ç« è² è²¬ä¸‹è»Šå°æµï¼›å°„æ“Šè² è²¬å¡«è£œç©ºæª”èˆ‡è¶£å‘³åœç•™ã€‚ä¸‰è€…åˆé«”ï¼Œå®Œæ•´è¦†è“‹ã€Œä¸Šè»Šâ†’è»Šä¸Šâ†’ä¸‹è»Šã€ã€‚
        </div>
      </div>
    </div>
  </div>

  <!-- Partner placeholder -->
  <div class="card" id="partners">
    <div class="row">
      <h2>åˆä½œåº—å®¶ï¼ˆé ç•™ç‰ˆä½ï¼‰</h2>
      <div class="pill">ä½ ä¹‹å¾Œæä¾›æ¸…å–®å³å¯ä¸Šæ¶</div>
    </div>
    <div class="notice">
      <div class="tiny">
        é€™è£¡æœªä¾†å¯æ”¾ï¼šåº—å®¶åç¨±ï½œå…Œæ›å…§å®¹ï½œåœ°åœ–é€£çµï½œå¯å…Œæ›å¾½ç« ï½œæ³¨æ„äº‹é …ã€‚<br/>
        ï¼ˆç›®å‰å…ˆç•™ç©ºï¼Œä¸å½±éŸ¿ä¸Šç·šï¼‰
      </div>
    </div>
  </div>

  <!-- Future content placeholder -->
  <div class="card" id="updates">
    <div class="row">
      <h2>æœ€æ–°æ¶ˆæ¯ / è·¯ç·šè³‡è¨Šï¼ˆé ç•™ç‰ˆä½ï¼‰</h2>
      <div class="pill">ä¹‹å¾Œå¯é€æ­¥æ–°å¢å…§å®¹</div>
    </div>
    <div class="notice">
      <div class="tiny">
        å»ºè­°æœªä¾†æ–°å¢çš„å€å¡Šï¼šAç·šè·¯ç·šåœ°åœ–ã€ç­æ¬¡/ç¥¨åˆ¸å…¥å£ã€æ´»å‹•å…¬å‘Šã€QR ä¸‹è¼‰é»ã€å¸¸è¦‹å•ç­”ã€åª’é«”å ±å°ã€ä½¿ç”¨è€…å›é¥‹ã€‚
      </div>
    </div>
  </div>

  <div class="footer">
    â€» æœ¬é ç‚ºå…ˆè¡Œç‰ˆè¡ŒéŠ·å…¥å£ç¶²ç«™ã€‚è‹¥ä½ è¦æˆ‘ä¸‹ä¸€æ­¥ã€ŒæŠŠä¸‰éŠæˆ²åšæˆåŒä¸€å€‹ç¶²ç«™çš„ /games/... çµæ§‹ï¼ˆä¸è·³ repoï¼‰ã€æˆ‘ä¹Ÿå¯ä»¥ç›´æ¥å¹«ä½ æ”¹æˆå¤šé æ¶æ§‹ã€‚
  </div>
</div>

<script>
  // ====== éŠæˆ²é€£çµ ======
  const GAME_LINKS = {
    stamp:  "https://thtsai820-cpu.github.io/Tour/",
    shoot:  "https://thtsai820-cpu.github.io/car-race/",
    riddle: "https://thtsai820-cpu.github.io/mystery-/"
  };

  const games = [
    {
      key: "riddle",
      icon: "ğŸ§©",
      short: "å³æ™‚è§£è¬",
      cover: "assets/img/cover-riddle.jpg",
      title: "å³æ™‚è·¯ç·šè§£è¬ï¼ˆAç·šï¼‰",
      desc: "åˆ°ç«™æ‰è§£é–ä¸‹ä¸€é—œã€‚æœ€èƒ½æ¨å‹•ã€ŒçœŸçš„å»æ­è»Šã€ã€‚",
      tags: ["åˆ°ç«™è§£é–", "è»Šä¸Šä¹Ÿèƒ½ç©", "Aç·šä¸»æ¨"]
    },
    {
      key: "stamp",
      icon: "ğŸ§¾",
      short: "é›†ç« ä»»å‹™",
      cover: "assets/img/cover-stamp.jpg",
      title: "Aç·šé›†ç« ä»»å‹™",
      desc: "ä¸‹è»Šæ¢ç´¢ã€å®Œæˆå¾½ç« ã€‚æœªä¾†å¯ä¸²åˆä½œåº—å®¶å…Œæ›ã€‚",
      tags: ["å°æµä¸‹è»Š", "å¾½ç« ", "å…Œæ›ç‰ˆä½å·²é ç•™"]
    },
    {
      key: "shoot",
      icon: "ğŸ¯",
      short: "æ™¯é»å°„æ“Š",
      cover: "assets/img/cover-shoot.jpg",
      title: "æ™¯é»å°„æ“Šå°éŠæˆ²",
      desc: "ä»¥çœŸå¯¦æ™¯é»ç…§ç‰‡ç‚ºèƒŒæ™¯ï¼Œç­‰å¾…ä¹Ÿä¸ç„¡èŠã€‚",
      tags: ["çœŸå¯¦ç…§ç‰‡èƒŒæ™¯", "æ‰‹æ©Ÿè§¸æ§", "è¶£å‘³åœç•™"]
    }
  ];

  function el(html){
    const t = document.createElement("template");
    t.innerHTML = html.trim();
    return t.content.firstChild;
  }

  const grid = document.getElementById("gameGrid");
  games.forEach(g=>{
    const link = GAME_LINKS[g.key];
    const card = el(`
      <a class="game" href="${link}" target="_blank" rel="noopener noreferrer" aria-label="${g.title}">
        <div class="cover" style="background-image:url('${g.cover}');background-size:cover;background-position:center;">
          <span style="background:rgba(0,0,0,.45);padding:6px 10px;border-radius:999px;">
            ${g.icon} ${g.short}
          </span>
        </div>
        <div class="body">
          <div class="pill">${g.icon} ${g.title}</div>
          <div class="sub">${g.desc}</div>
          <div class="tags">${g.tags.map(x=>`<span class="tag">${x}</span>`).join("")}</div>
          <div class="hr"></div>
          <div class="tiny">é–‹å•Ÿé€£çµï¼š${link}</div>
        </div>
      </a>
    `);
    grid.appendChild(card);
  });

  document.getElementById("startBtn").onclick = ()=>{
    window.open(GAME_LINKS.riddle + "?v=" + Date.now(), "_blank", "noopener,noreferrer");
  };
  document.getElementById("howBtn").onclick = ()=>{
    document.getElementById("how").scrollIntoView({behavior:"smooth", block:"start"});
  };
</script>

<script>
/* ========= å½±ç‰‡è§£é–å¾½ç«  + Hero é¡¯ç¤ºå¾½ç« ï¼ˆå–®ä¸€ç‰ˆæœ¬ï¼Œä¸è¡çªï¼‰ ========= */
(function(){
  var BADGE_KEY = "TM_BADGE_LOW_CARBON_V1";
  var video = document.getElementById("ecoVideo");
  var pill = document.getElementById("ecoBadgePill");
  var hint = document.getElementById("ecoHint");
  var resetBtn = document.getElementById("ecoResetBtn");
  var heroFloat = document.getElementById("heroBadgeFloat");

  function isUnlocked(){
    try{ return localStorage.getItem(BADGE_KEY) === "1"; }catch(e){ return false; }
  }

  function renderHeroBadge(){
    if(!heroFloat) return;

    if(!isUnlocked()){
      heroFloat.style.display = "none";
      heroFloat.innerHTML = "";
      return;
    }

    heroFloat.style.display = "block";
    heroFloat.innerHTML = `
      <div style="
        position:absolute; right:14px; top:14px;
        display:flex; align-items:center; gap:10px;
        padding:10px 12px;
        border-radius:14px;
        border:1px solid rgba(122,162,255,.55);
        background:rgba(122,162,255,.18);
        box-shadow:0 12px 26px rgba(0,0,0,.35);
      ">
        <div style="
          width:40px;height:40px;border-radius:12px;
          display:flex;align-items:center;justify-content:center;
          background:rgba(0,0,0,.25);
          font-size:22px;
        ">ğŸ…</div>
        <div>
          <div style="font-weight:1000;letter-spacing:.3px">ä½ç¢³æ—…äºº</div>
          <div style="font-size:12px;opacity:.88">å·²å®Œæˆå½±ç‰‡æ•™è‚²ä»»å‹™</div>
        </div>
      </div>
    `;
  }

  function setUnlockedUI(){
    try{ localStorage.setItem(BADGE_KEY, "1"); }catch(e){}
    if(pill){
      pill.textContent = "âœ… å·²è§£é–ï¼šä½ç¢³æ—…äºº";
      pill.style.borderColor = "rgba(122,162,255,.55)";
      pill.style.background = "rgba(122,162,255,.12)";
    }
    if(hint){
      hint.innerHTML = "ğŸ‰ æ­å–œï¼ä½ å·²è§£é– <b>ä½ç¢³æ—…äºº</b> å¾½ç« ï¼ˆæœƒé¡¯ç¤ºåœ¨ Hero å€ï¼‰ã€‚";
    }
    renderHeroBadge();
  }

  function setLockedUI(){
    if(pill){
      pill.textContent = "ğŸ”’ å°šæœªè§£é–";
      pill.style.borderColor = "";
      pill.style.background = "";
    }
    if(hint){
      hint.textContent = "è«‹æ’­æ”¾å½±ç‰‡è‡³ 90%ï¼ˆæˆ–æ’­å®Œï¼‰å³å¯è§£é–å¾½ç« ã€‚";
    }
    renderHeroBadge();
  }

  // init
  if(isUnlocked()) setUnlockedUI();
  else setLockedUI();

  if(resetBtn){
    resetBtn.onclick = function(){
      try{ localStorage.removeItem(BADGE_KEY); }catch(e){}
      setLockedUI();
      if(video){
        try{ video.currentTime = 0; }catch(e){}
      }
      alert("å·²é‡ç½®å¾½ç« ã€‚é‡æ–°çœ‹å½±ç‰‡å³å¯å†è§£é–ã€‚");
    };
  }

  if(!video) return;

  video.addEventListener("loadedmetadata", function(){
    if(hint) hint.textContent = "å½±ç‰‡å·²è¼‰å…¥ã€‚æ’­æ”¾é” 90%ï¼ˆæˆ–æ’­å®Œï¼‰å³å¯è§£é–å¾½ç« ã€‚";
  });

  function checkProgress(){
    if(isUnlocked()) return;
    if(!video.duration || !isFinite(video.duration)) return;

    var ratio = video.currentTime / video.duration;
    if(ratio >= 0.90){
      setUnlockedUI();
    }else{
      if(hint){
        hint.textContent = "è§€çœ‹é€²åº¦ï¼š" + Math.round(ratio * 100) + "%ï¼ˆé” 90% è§£é–ï¼‰";
      }
    }
  }

  video.addEventListener("timeupdate", checkProgress);
  video.addEventListener("ended", function(){
    if(!isUnlocked()) setUnlockedUI();
  });

  // è‹¥å…¶ä»–åˆ†é è§£é–ï¼ˆåŒç¶²åŸŸï¼‰ä¹Ÿèƒ½åŒæ­¥æ›´æ–°
  window.addEventListener("storage", function(){
    if(isUnlocked()) setUnlockedUI();
    else setLockedUI();
  });
})();
</script>

</body>
</html>
